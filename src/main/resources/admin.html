<!DOCTYPE html>
<!-- saved from url=(0069)https://almende.github.io/vis/examples/graph2d/15_streaming_data.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta content="utf-8" http-equiv="encoding">
  <title>Response time</title>

  <style type="text/css">
    body, html, select {
      font: 10pt sans-serif;
    }
  </style>

  <script src="./vis.min.js"></script>
  <link href="./vis.min.css" rel="stylesheet" type="text/css">
</head>
<body>
<h2>Response time</h2>

<div id="visualization"/>

<script type="text/javascript">
  var DELAY = 50;

  var container = document.getElementById('visualization');
  var dataset = new vis.DataSet();

  var options = {
    start: vis.moment().add(-300, 'seconds'), // changed so its faster
    end: vis.moment(),
    dataAxis: {
      left: {
        range: {
          min:0, max: 10
        }
      }
    },
    style : 'points',
    drawPoints: {
      style: 'circle' // square, circle
    },
    shaded: {
      orientation: 'bottom' // top, bottom
    }
  };
  var graph2d = new vis.Graph2d(container, dataset, options);

  function y(x) {
    let rand = Math.random() * 11.0;
  	return rand;
  }

  function renderStep() {
    var now = vis.moment();
    var range = graph2d.getWindow();
    var interval = range.end - range.start;
	graph2d.setWindow(now - interval, now, {animation: false});
    requestAnimationFrame(renderStep);
  }
  renderStep();

  function addDataPoint() {
    // add a new data point to the dataset
     let xNew = Math.random() * 10.0;
  	 let yNew = Math.random() * 10.0;

      var now = vis.moment() - (xNew * 100000);
      console.log("x: " + now);
      console.log("y: " + yNew);
    dataset.add({
      x: now,
      y: yNew
    });

    // remove all data points which are no longer visible
    var range = graph2d.getWindow();
    var interval = range.end - range.start;
    var oldIds = dataset.getIds({
      filter: function (item) {
        return item.x < range.start - interval;
      }
    });
    dataset.remove(oldIds);

    setTimeout(addDataPoint, DELAY);
  }
  addDataPoint();
</script>

</body></html>